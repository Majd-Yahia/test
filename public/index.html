<!DOCTYPE html>
<html>
  <head>
    <title>Ping Pong Game</title>
  </head>
  <body>
    <canvas
      id="canvas"
      width="800"
      height="400"
      style="border: 1px solid #d3d3d3"
    ></canvas>
    <script type="text/javascript" src="js/app.js"></script>
    <script type="text/javascript">
      //Sample functions, remove these functions and design ping-pong game with onInit and onUpdate.

      app.onInit = function () {
        const app = this;

        // Add margin safety for canvas.
        let safetyMargin = 30;

        // Add canvas width, height - safety
        document.getElementById("canvas").width =
          window.innerWidth - safetyMargin;
        document.getElementById("canvas").height =
          window.innerHeight - safetyMargin;

        // Set the width and height of canvas in render.
        this.width = window.innerWidth - safetyMargin;
        this.height = window.innerHeight - safetyMargin;

        this.nodes.push({
          id: "racketOne",
          x: 10,
          y: app.height / 2,
          width: 10,
          height: 50,
          color: "red",
          direction: 0,
          speed: 4,
        });

        this.nodes.push({
          id: "racketTwo",
          x: app.width - 20,
          y: app.height / 2,
          width: 10,
          height: 50,
          color: "red",
          direction: 0,
          speed: 4,
        });

        //======================================================================================================================================================
        // Keycode for W:87, S:83
        // Keycode for arrow up: 38, down: 40
        //======================================================================================================================================================
        // Event listener for keydown.
        document.addEventListener("keydown", function (e) {
          // this returns the document so we need to save variables for access.
          switch (e.which) {
            case 83:
              app.getNode("racketOne").direction = -1;
              break;
            case 87:
              app.getNode("racketOne").direction = 1;
              break;
            case 38:
              app.getNode("racketTwo").direction = 1;
              break;
            case 40:
              app.getNode("racketTwo").direction = -1;
              break;
            default:
              break;
          }
        });

        // Event listener for keyup.
        document.addEventListener("keyup", function (e) {
          switch (e.which) {
            case 83:
              app.getNode("racketOne").direction = 0;
              break;
            case 87:
              app.getNode("racketOne").direction = 0;
              break;
            case 38:
              app.getNode("racketTwo").direction = 0;
              break;
            case 40:
              app.getNode("racketTwo").direction = 0;
              break;
            default:
              break;
          }
        });
      };

      app.onUpdate = function (time) {
        // Caching some variables for ease of access.
        let playerOne = this.getNode("racketOne"); // Cache the playerOne.
        let playerTwo = this.getNode("racketTwo"); // Cache the playerTwo.

        playerOne.y -= playerOne.direction * playerOne.speed; // Move playerOne horizontally based on the direction * speed.
        playerTwo.y -= playerTwo.direction * playerTwo.speed; // Move playerRwo vertically based on the direction * speed.
      };
    </script>
  </body>
</html>
